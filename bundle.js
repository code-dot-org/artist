!function(t){var a={};function i(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=a,i.d=function(t,a,e){i.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,a){if(1&a&&(t=i(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var r in t)i.d(e,r,function(a){return t[a]}.bind(null,r));return e},i.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(a,"a",a),a},i.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},i.p="",i(i.s=6)}([function(t,a,i){t.exports=i.p+"d0ba486d5318ec235180d40b44d0621e.png"},function(t,a,i){t.exports=i.p+"6cdcbe95467a4f5d7d425b4f6c548a0b.png"},function(t,a,i){t.exports=i.p+"f51ce2719c3ddb76e13e300d6a4e9624.png"},function(t,a,i){t.exports=i.p+"75fc859f5a84ab6db3c1e527082d4649.png"},function(t,a,i){t.exports=i.p+"16808a707b60a4f23e1c07c6ffff3e9d.png"},function(t,a){var i=[{x:15,when:"after"},{x:26,when:"after"},{x:37,when:"after"},{x:46,when:"after"},{x:60,when:"after"},{x:65,when:"after"},{x:66,when:"after"},{x:64,when:"after"},{x:62,when:"before"},{x:55,when:"before"},{x:48,when:"before"},{x:33,when:"before"},{x:31,when:"before"},{x:22,when:"before"},{x:17,when:"before"},{x:12,when:"before"},{x:8,when:"after"},{x:10,when:"after"}];t.exports=class{constructor(t={}){this.x=200,this.y=200,this.heading=90,this.penDownValue=!0,this.avatar=t.avatar,this.isFrozenSkin=!!t.isFrozenSkin,this.isK1=!!t.isK1,this.decorationAnimationImage=t.decorationAnimationImage,this.showDecoration=t.showDecoration,this.turtleFrame_=0,this.isPredrawing_=!1,this.currentPathPattern=new Image,this.isDrawingWithPattern=!1,this.shouldDrawNormalized_=!1,this.ctxAnswer=this.createCanvas_("answer",400,400).getContext("2d"),this.ctxImages=this.createCanvas_("images",400,400).getContext("2d"),this.ctxPredraw=this.createCanvas_("predraw",400,400).getContext("2d"),this.ctxScratch=this.createCanvas_("scratch",400,400).getContext("2d"),this.ctxPattern=this.createCanvas_("pattern",400,400).getContext("2d"),this.ctxFeedback=this.createCanvas_("feedback",154,154).getContext("2d"),this.ctxThumbnail=this.createCanvas_("thumbnail",180,180).getContext("2d"),this.ctxNormalizedScratch=this.createCanvas_("normalizedScratch",400,400).getContext("2d"),this.ctxNormalizedAnswer=this.createCanvas_("normalizedAnswer",400,400).getContext("2d"),this.displayCanvas=this.createCanvas_("display",400,400),this.ctxDisplay=this.displayCanvas.getContext("2d")}resetTurtleFrame(){this.turtleFrame_=0}createCanvas_(t,a,i){var e=document.createElement("canvas");return e.id=t,e.width=a,e.height=i,e}drawTurtle(){if(this.avatar.visible){this.drawDecorationAnimation("before");var t=Math.floor(this.heading*this.avatar.numHeadings/360);this.isFrozenSkin&&(t=((t=this.avatar.numHeadings-t)+this.avatar.numHeadings/2)%this.avatar.numHeadings);var a=this.avatar.width*t,i=this.avatar.height*this.turtleFrame_;this.turtleFrame_=(this.turtleFrame_+1)%this.avatar.numFrames;var e=this.avatar.width,r=this.avatar.height,s=this.avatar.width,h=this.avatar.height,n=this.x-s/2,o=this.y-h+7;this.avatar.image&&(a<0||i<0||a+e-0>this.avatar.image.width||i+r>this.avatar.image.height||(0!==this.avatar.image.width&&this.ctxDisplay.drawImage(this.avatar.image,Math.round(a),Math.round(i),e-0,r,Math.round(n),Math.round(o),s-0,h),this.drawDecorationAnimation("after")))}}drawDecorationAnimation(t){if(this.showDecoration()){var a=(this.turtleFrame_+10)%19,e=Math.floor(this.heading*this.avatar.numHeadings/360);if(e=((e=this.avatar.numHeadings-e)+this.avatar.numHeadings/2)%this.avatar.numHeadings,i[e].when===t){var r=85*a,s=this.x-42.5-15-15+i[e].x,h=this.y-42.5-100;0!==this.decorationAnimationImage.width&&this.ctxDisplay.drawImage(this.decorationAnimationImage,Math.round(r),Math.round(0),85,85,Math.round(s),Math.round(h),85,85)}}}display(){var t=this.ctxDisplay.fillStyle;this.ctxDisplay.fillStyle="#fff",this.ctxDisplay.clearRect(0,0,this.ctxDisplay.canvas.width,this.ctxDisplay.canvas.width),this.ctxDisplay.fillStyle=t,this.ctxDisplay.globalCompositeOperation="copy",this.ctxDisplay.globalCompositeOperation="source-over",this.ctxDisplay.drawImage(this.ctxImages.canvas,0,0),this.ctxDisplay.globalCompositeOperation="source-over",this.ctxDisplay.drawImage(this.ctxPredraw.canvas,0,0),this.isFrozenSkin?this.ctxDisplay.globalAlpha=.4:this.ctxDisplay.globalAlpha=.3,this.ctxDisplay.drawImage(this.ctxAnswer.canvas,0,0),this.ctxDisplay.globalAlpha=1,this.ctxDisplay.globalCompositeOperation="source-over",this.ctxDisplay.drawImage(this.ctxPattern.canvas,0,0),this.ctxDisplay.globalCompositeOperation="source-over",this.ctxDisplay.drawImage(this.ctxScratch.canvas,0,0),this.drawTurtle()}jumpTo(t){let[a,i]=t;this.x=Number(a),this.y=Number(i)}jumpForward(t){this.x+=t*Math.sin(this.degreesToRadians_(this.heading)),this.y-=t*Math.cos(this.degreesToRadians_(this.heading))}circleAt_(t,a,i){this.ctxScratch.arc(t,a,i,0,2*Math.PI)}drawToTurtle_(t){0===t?this.ctxScratch.lineTo(this.x+.1,this.y):this.ctxScratch.lineTo(this.x,this.y)}pointTo(t){this.setHeading(t+90)}turnByDegrees(t){this.setHeading(this.heading+t)}setHeading(t){t=this.constrainDegrees_(t),this.heading=t}reset(t=90,a=200,i=200){this.x=a,this.y=i,this.heading=t,this.penDownValue=!0,this.avatar.visible=!0,this.resetTurtleFrame(),this.ctxScratch.canvas.width=this.ctxScratch.canvas.width,this.ctxPattern.canvas.width=this.ctxPattern.canvas.width,this.isFrozenSkin?(this.ctxScratch.strokeStyle="rgb(255,255,255)",this.ctxScratch.fillStyle="rgb(255,255,255)",this.ctxScratch.lineWidth=2):(this.ctxScratch.strokeStyle="#000000",this.ctxScratch.fillStyle="#000000",this.ctxScratch.lineWidth=5),this.ctxScratch.lineCap="round",this.ctxScratch.font="normal 18pt Arial",this.display(),this.ctxFeedback.clearRect(0,0,this.ctxFeedback.canvas.width,this.ctxFeedback.canvas.height)}degreesToRadians_(t){return t*(Math.PI/180)}constrainDegrees_(t){return(t%=360)<0&&(t+=360),t}moveForward(t,a){this.penDownValue?this.isDrawingWithPattern&&(this.drawForwardLineWithPattern_(t),!this.isFrozenSkin)||this.drawForward_(t,a):this.jumpForward(t)}drawForward_(t,a){this.shouldDrawJoints_()?this.drawForwardWithJoints_(t,a):this.drawForwardLine_(t)}drawForwardWithJoints_(t,a){var i=t,e=50*(a?Math.sqrt(2):1);for(i>=e&&this.drawJointAtTurtle_();i>0;){var r=i>=e,s=r?e:i;i-=s,this.drawForwardLine_(s),r&&this.drawJointAtTurtle_()}}drawForwardLine_(t){this.isFrozenSkin?(this.ctxScratch.beginPath(),this.ctxScratch.moveTo(this.stepStartX,this.stepStartY),this.jumpForward(t),this.drawToTurtle_(t),this.ctxScratch.stroke()):(this.ctxScratch.beginPath(),this.ctxScratch.moveTo(this.x,this.y),this.jumpForward(t),this.drawToTurtle_(t),this.ctxScratch.stroke())}drawForwardLineWithPattern_(t){var a,i,e;if(this.isFrozenSkin){this.ctxPattern.moveTo(this.stepStartX,this.stepStartY),a=this.currentPathPattern,i=this.stepStartX,e=this.stepStartY;var r,s=Math.abs(this.stepDistanceCovered);this.ctxPattern.save(),this.ctxPattern.translate(i,e),this.ctxPattern.rotate(this.degreesToRadians_(this.heading-90)),r=s%this.smoothAnimateStepSize==0?this.smoothAnimateStepSize:s>this.smoothAnimateStepSize?s%this.smoothAnimateStepSize:s,a.width>0&&a.height>0&&r>0&&this.ctxPattern.drawImage(a,Math.round(s),0,r,a.height,Math.round(this.stepDistanceCovered-r-2),Math.round(-18),r,a.height),this.ctxPattern.restore()}else this.ctxScratch.moveTo(this.x,this.y),a=this.currentPathPattern,i=this.x,e=this.y,this.jumpForward(t),this.ctxScratch.save(),this.ctxScratch.translate(i,e),this.ctxScratch.rotate(this.degreesToRadians_(this.heading-90)),t>0&&0!==a.width?this.ctxScratch.drawImage(a,0,0,t,a.height,-a.height/4,-a.height/2,t+a.height/2,a.height):t<0&&0!==a.width&&this.ctxScratch.drawImage(a,a.width,0,t,a.height,-a.height/4,-a.height/2,t+a.height/2,a.height),this.ctxScratch.restore()}shouldDrawJoints_(){return this.isK1&&!this.isPredrawing_}drawJointAtTurtle_(){this.ctxScratch.beginPath(),this.ctxScratch.moveTo(this.x,this.y),this.circleAt_(this.x,this.y,4),this.ctxScratch.stroke()}}},function(t,a,i){const e=i(5);window.viz=new e({isFrozenSkin:!1,avatar:{src:i(4),width:70,height:51,numHeadings:180,numFrames:1,visible:!0},lineStylePatternOptions:[],linePatterns:{rainbowLine:i(3),ropeLine:i(2),squigglyLine:i(1),swirlyLine:i(0)}}),Promise.all([function(t,a){return new Promise((i,e)=>{const r=new Image;r.onload=(()=>i()),r.onerror=(()=>e()),r.src=t,a.image=r})}(viz.avatar.src,viz.avatar)]).then(()=>{const t=[];document.body.appendChild(viz.ctxDisplay.canvas);for(let a=0;a<5;a++)t.push({command:"moveForward",args:[100]}),t.push({command:"turnByDegrees",args:[216]});const a=setInterval(()=>{const i=t.shift();i?(viz[i.command].apply(viz,i.args),viz.display()):clearInterval(a)},500)})}]);